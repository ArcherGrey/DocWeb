# javascript 作用域、上下文、执行环境、作用域链等相关内容

- 全局作用域
- 局部作用域

## 全局作用域和全局变量

如果变量定义在函数之外，则变量就处于全局作用域中：
```
// 默认全局作用域
var a = 1;
function fn(){};
```
全局作用域中的变量可以在任何其他作用域中访问和修改：
```
var a = 1;
function fn(){
    console.log(a); // 显示 a
    a = 2; // 修改 a 
}
```

全局变量的声明有三种方式：
- 不带 `var` 无论是在哪里，甚至是在函数内部声明，都会隐式声明成全局变量
- 带 `var` 在函数外部声明，这种是显式声明
- 使用 `window` 全局对象来声明，全局对象的属性对应也是全局变量

全局变量的优点：
可以减少变量个数，减少由于实参和形参的数据传递带来的时间消耗

全局变量的缺点：
- 全局变量保存在静态存储区，程序开始运行时为其分配内存，程序结束释放内存，和局部变量的动态分配、动态释放相比，生存期比较长，过多的全局变量会占用较多的内存单元
- 全局变量破坏了函数的封装性能，使得函数对全局变量产生依赖，同时降低了函数的可移植性
- 全局变量使得函数的可读性降低，由于多个函数可能使用相同的全局变量，对于程序的查错和调试都非常不利

注：尽可能少的使用全局变量

## 局部作用域
`javascript` 和 `C++` 之类的语言不同，它的局部作用域是以函数为单位，而不是块级作用域。（注：最新的标准提供了块级作用域）

每个函数被调用的时候都具有不同的作用域，意味着相同名称的变量可以在不同的函数中使用，这是因为它们都是属于不同的作用域，在其他函数中不可被访问。


## 块级作用域

块级声明包括：
- `if`
- `switch`
- `for`
- `while`

`es6` 中引入了 `let` 和 `const` ，这些关键字支持在块级声明中创建使用局部作用域。

## 生存周期

全局作用域的生存周期和应用相同，局部作用域只在函数调用执行期间存在。

## 上下文

上下文指的是在作用域中 `this` 所指向的对象：
- 全局作用域中，上下文总是 `window` 对象
- 如果作用域定义在一个对象的方法中，上下文就是这个方法所在的那个对象
- 如果使用 `new` 调用函数时，上下文会被设置为调用函数的实例

在使用严格模式下的全局作用域中调用函数时，上下文默认是 `undefined`，因为严格模式禁止 `this` 指向全局对象。

## 执行环境

执行环境 = 作用域

执行环境有两个阶段：
- 创建：1.创建变量对象 2.创建作用域链 3.设置上下文的值
- 执行

## 执行环境对象

包含三部分：
- 执行环境中的变量对象
- 执行环境中的函数对象
- 执行环境中的上下文

## 作用域链

在执行环境创建阶段，作用域链在变量对象之后创建。

作用域链包含变量对象，作用域链用于解析变量，当解析一个变量时，开始从最内层沿着父级寻找所需的变量或者其他资源,作用域链包含自己执行环境以及父级环境中包含的变量对象

## 词法作用域

指的是内层函数可以访问父级作用域的变量等资源。意味着子函数词法绑定到了父级执行环境。词法作用域有时候和静态作用域有关。

- 子执行环境可以访问父级变量，反之不行
- 在不同执行环境中同名变量优先级在执行



